
<IfModule mod_ssl.c>
	<VirtualHost _default_:443>
		ServerAdmin webmaster@localhost
		ServerName localhost

		DocumentRoot /var/www/html
		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined
		
		# SSL
		SSLEngine on
		SSLCertificateFile	/etc/apache2/ssl/localhost-cert.pem
		SSLCertificateKeyFile	/etc/apache2/ssl/localhost-key.pem
		
		# andmatca
		SSLCACertificateFile	/etc/apache2/ssl/andmatca-cacert.pem
		SSLCARevocationFile	/etc/apache2/ssl/andmatca-crl.pem
		
		# /netbeans
		Alias /netbeans /home/ep/NetBeansProjects
		<Directory /home/ep/NetBeansProjects>
			Options FollowSymLinks
			Require all granted
			AllowOverride all
		</Directory>
		
		# CERT na .../admin in .../prodajalec
		<LocationMatch "/netbeans/ep-trgovina/php/index.php/x509login">
			SSLVerifyClient require
			SSLVerifyDepth 1
			SSLOptions +ExportCertData
		</LocationMatch>
	
	
		#   SSL Engine Options:
		#   Set various options for the SSL engine.
		#   o FakeBasicAuth:
		#	 Translate the client X.509 into a Basic Authorisation.  This means that
		#	 the standard Auth/DBMAuth methods can be used for access control.  The
		#	 user name is the `one line' version of the client's X.509 certificate.
		#	 Note that no password is obtained from the user. Every entry in the user
		#	 file needs this password: `xxj31ZMTZzkVA'.
		#   o ExportCertData:
		#	 This exports two additional environment variables: SSL_CLIENT_CERT and
		#	 SSL_SERVER_CERT. These contain the PEM-encoded certificates of the
		#	 server (always existing) and the client (only existing when client
		#	 authentication is used). This can be used to import the certificates
		#	 into CGI scripts.
		#   o StdEnvVars:
		#	 This exports the standard SSL/TLS related `SSL_*' environment variables.
		#	 Per default this exportation is switched off for performance reasons,
		#	 because the extraction step is an expensive operation and is usually
		#	 useless for serving static content. So one usually enables the
		#	 exportation for CGI and SSI requests only.
		#   o OptRenegotiate:
		#	 This enables optimized SSL connection renegotiation handling when SSL
		#	 directives are used in per-directory context.
		#SSLOptions +FakeBasicAuth +ExportCertData +StrictRequire
		<FilesMatch "\.(cgi|shtml|phtml|php)$">
				SSLOptions +StdEnvVars
		</FilesMatch>
		<Directory /usr/lib/cgi-bin>
				SSLOptions +StdEnvVars
		</Directory>

	</VirtualHost>
</IfModule>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
